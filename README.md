# 视频会议系统

这是一个基于Python的视频会议系统，支持多人音视频通话、屏幕共享和文字聊天等功能。该系统采用客户端-服务器架构，使用WebSocket进行实时通信。

## 功能特性

- 多人视频会议
- 实时音频通话
- 屏幕共享
- 文字聊天
- 参会者列表管理
- 会议创建与加入
- 视频网格自适应布局

## 系统架构

### 核心组件

1. **服务器端 (`conf_server.py`)**
   - 处理用户连接和会议管理
   - 音视频流转发
   - 实现了三个独立的WebSocket服务器：
     - 主服务器：处理基础通信和会议管理
     - 视频服务器：专门处理视频流
     - 屏幕共享服务器：处理屏幕共享数据

2. **客户端 (`conf_client.py`)**
   - 实现与服务器的通信
   - 管理音视频流的发送和接收
   - 处理会议相关的事件

3. **GUI界面 (`GUI.py`)**
   - 实现了完整的图形用户界面
   - 包含登录、会议列表和会议室三个主要界面
   - 使用Tkinter构建

4. **视频管理器 (`VideoManager.py`)**
   - 处理视频流的显示和布局
   - 实现了自适应的视频网格布局
   - 管理屏幕共享的显示

5. **音频混音器 (`AudioMixer.py`)**
   - 处理多路音频流的混合
   - 实现音量平衡和防止失真

### 工具组件

- **配置管理 (`config.py`)**：系统配置参数
- **协议定义 (`protocol.py`)**：定义了会议相关的数据结构
- **工具函数 (`util.py`)**：提供音视频采集和处理功能
- **控制栏 (`Controlbar.py`)**：实现会议控制按钮

## 依赖要求

```
# requirements.txt
python-socketio>=5.7.2
aiohttp>=3.8.4
opencv-python>=4.7.0
pillow>=9.5.0
pyaudio>=0.2.13
pyautogui>=0.9.53
numpy>=1.24.3
```

## 安装说明

1. 克隆仓库：
```bash
git clone <repository-url>
cd video-conference-system
```

2. 创建并激活虚拟环境（推荐）：
```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
venv\Scripts\activate     # Windows
```

3. 安装依赖：
```bash
pip install -r requirements.txt
```

## 使用说明

1. 启动服务器：
```bash
python conf_server.py
```
服务器默认在本地8888端口启动。

2. 启动客户端：
```bash
python GUI.py
```

3. 使用流程：
   - 输入用户名登录
   - 在会议列表界面创建新会议或加入已有会议
   - 在会议室内可以：
     - 点击麦克风图标开启/关闭音频
     - 点击摄像头图标开启/关闭视频
     - 点击屏幕图标开启/关闭屏幕共享
     - 使用右侧聊天框发送文字消息
     - 查看参与者列表
     - 会议创建者可以关闭会议
     - 参与者可以离开会议

## 开发说明

### 项目结构
```
.
├── AudioMixer.py     # 音频混音处理
├── conf_client.py    # 客户端核心实现
├── conf_server.py    # 服务器核心实现
├── config.py         # 配置文件
├── Controlbar.py     # 控制栏UI组件
├── GUI.py           # 图形界面实现
├── protocol.py      # 协议定义
├── util.py          # 工具函数
└── VideoManager.py  # 视频显示管理
```

### 扩展开发

1. 修改配置：
   - 在`config.py`中可以修改服务器地址、端口等配置
   - 可以调整视频分辨率、音频采样率等参数

2. 自定义功能：
   - 添加新的会议功能需要同时修改服务器和客户端
   - 在`protocol.py`中定义新的消息类型
   - 在服务器端添加相应的事件处理器
   - 在客户端实现对应的功能和UI

## 注意事项

1. 系统要求：
   - Python 3.7+
   - 支持WebSocket的现代浏览器
   - 摄像头和麦克风设备

2. 性能考虑：
   - 视频质量和帧率可在`config.py`中调整
   - 建议在局域网环境下使用
   - 参与者数量建议不超过10人

3. 已知限制：
   - 当前仅支持一人同时进行屏幕共享
   - 视频分辨率固定为480x480
   - 仅支持单一音频设备

## 故障排除

1. 无法连接服务器：
   - 检查服务器是否正在运行
   - 确认防火墙设置
   - 验证配置文件中的服务器地址和端口

2. 音视频问题：
   - 确保设备权限已授予
   - 检查设备驱动是否正确安装
   - 验证音视频设备是否被其他程序占用

3. 性能问题：
   - 降低视频质量和帧率
   - 检查网络带宽
   - 减少同时在线的参与者数量
